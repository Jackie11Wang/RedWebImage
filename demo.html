<html>

<head>
    <title>RWI</title>
    <meta charset="utf-8"></meta>
</head>

<body>
    <canvas id="webGL" width="500px" height="500px"></canvas>

    <script>
        var canvasElement = document.getElementById("webGL");
        var context = canvasElement.getContext('webgl');

        context.clearColor(1.0, 1.0, 0.0, 1.0);
        context.clear(context.COLOR_BUFFER_BIT);

        var vertexShaderSource =
            "attribute vec2 pos;" +
            "void main(){" +
            "    gl_Position = vec4(pos.xy * 0.5,0.0,1.0);" +
            "}";

        var fragmentShaderSource =
            "void main(){" +
            "    gl_FragColor = vec4(1.0,0.0,0.0,1.0);" +
            "}";

        var program = initShader(context, vertexShaderSource, fragmentShaderSource);


        /** start设置定点数据 **/
        var data = new Float32Array([-1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0]);
        var buffer = context.createBuffer();

        context.bindBuffer(context.ARRAY_BUFFER, buffer);
        context.bufferData(context.ARRAY_BUFFER, data, context.STATIC_DRAW);

        var posLocation = context.getAttribLocation(program, 'pos');
        context.vertexAttribPointer(posLocation, 2, context.FLOAT, false, 0, 0);
        context.enableVertexAttribArray(posLocation);
        /** end设置定点数据 **/

        /** start设置索引数据 **/
        var indicesData = new Uint8Array([0, 1, 2, 0, 2, 3]);
        var indexBuffer = context.createBuffer();
        context.bindBuffer(context.ELEMENT_ARRAY_BUFFER, indexBuffer);
        context.bufferData(context.ELEMENT_ARRAY_BUFFER, indicesData, context.STATIC_DRAW);

        context.drawElements(context.TRIANGLES, indicesData.length, context.UNSIGNED_BYTE, 0);
        /** end设置索引数据 **/



        function initShader(gl, vertexShaderSource, fragmentShaderSource) {
            var vertexShader = gl.createShader(gl.VERTEX_SHADER);
            var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);

            gl.shaderSource(vertexShader, vertexShaderSource);
            gl.shaderSource(fragmentShader, fragmentShaderSource);

            gl.compileShader(vertexShader);
            gl.compileShader(fragmentShader);

            var program = gl.createProgram();
            gl.attachShader(program, vertexShader);
            gl.attachShader(program, fragmentShader);

            gl.linkProgram(program);

            gl.useProgram(program);

            console.error(gl.getShaderInfoLog(vertexShader));
            console.error(gl.getShaderInfoLog(fragmentShader));

            return program;
        }
    </script>
</body>

</html>
